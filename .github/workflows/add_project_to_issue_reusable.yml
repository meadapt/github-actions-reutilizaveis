name: Add project to issue

on:
  workflow_call:
    secrets:
      GH_TOKEN:
        description: 'A token passed from the caller workflow'
        required: true
      ACCOUNT_TYPE:
        description: 'A github account type that owns the repo. It must be "users" or "orgs".'
        required: true
      PROJECT_NUMBER:
        description: 'A GitHub project number of the given user that will be updated'
        required: true

jobs:
  add-project-to-issue:
    name: Add project to issue
    runs-on: ubuntu-latest
    steps:
      - name: See repo owner/name
        id: split
        env:
          OWNER_NAME: ${{ github.repository }}
        run: echo "::set-output name=owner::${OWNER_NAME%/*}"
      - uses: actions/add-to-project@v0.4.0
        with:
          project-url: "https://github.com/${{ secrets.ACCOUNT_TYPE }}/${{ steps.split.outputs.owner }}/projects/${{ secrets.PROJECT_NUMBER }}"
          github-token: ${{ secrets.GH_TOKEN }}
